---
apiVersion: volsync.backube/v1alpha1
kind: ReplicationDestination
metadata:
  name: "${SRC_PVC}-rclone-bootstrap-local"
spec:
  trigger:
    manual: "restore-once-bootstrap"
  rclone:
    rcloneConfigSection: "garage-volsync"
    destinationPVC: "${SRC_PVC}"
    rcloneDestPath: "rclone/${APP}/${SRC_PVC}"
    rcloneConfig: "volsync-local-rclone-secret"
    copyMethod: "Direct"
    storageClassName: "${STORAGE_CLASS}"
    capacity: "${SIZE:=20Gi}"
    accessModes: ["ReadWriteOnce"]
    moverSecurityContext:
      runAsNonRoot: true
      runAsUser: ${APP_UID}
      runAsGroup: ${APP_UID}
      fsGroup: ${APP_UID}
      seccompProfile: { type: "RuntimeDefault" }
    moverResources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 1
        memory: 6Gi
    customCA:
      secretName: heyjohn-internal-ca
      key: ca.crt
