---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: linkerd
  namespace: linkerd
spec:
  dependsOn:
    - name: linkerd-cni
      namespace: flux-system
  values:
    cniEnabled: true
    enableEndpointSlices: true
    policyController:
      resources:
        cpu:
          limit: 20m
          request: 10m
        memory:
          limit: 50Mi
          request: 10Mi
    proxy:
      # -- The `cpu.limit` and `cores` should be kept in sync. The value of `cores`
      # must be an integer and should typically be set by rounding up from the
      # limit. E.g. if cpu.limit is '1500m', cores should be 2.
      cores: 0
      resources:
        cpu:
          limit: 20m
          request: 10m
        memory:
          limit: 50Mi
          request: 10Mi
    proxyInit:
      resources:
        cpu:
          limit: 100m
          request: 10m
        memory:
          limit: 50Mi
          request: 10Mi
    # -|- CPU and Memory resources required by the identity controller (see `proxy.resources` for sub-fields)
    #identityResources:
    #identityProxyResources:
    #proxyInjectorResources:
    #proxyInjectorProxyResources:
    #spValidatorResources:
    installNamespace: false
    nodeSelector:
      kubernetes.io/os: linux
      kubernetes.io/arch: amd64
